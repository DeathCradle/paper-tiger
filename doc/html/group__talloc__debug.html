<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>Paper Tiger: The talloc debugging support functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Paper Tiger
   </div>
   <div id="projectbrief">An open-source Terraria server written in C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">The talloc debugging support functions<div class="ingroups"><a class="el" href="group__talloc.html">The talloc API</a> &raquo; <a class="el" href="group__talloc__ref.html">The talloc reference function.</a> &raquo; <a class="el" href="group__talloc__array.html">The talloc array functions</a> &raquo; <a class="el" href="group__talloc__string.html">The talloc string functions.</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>To aid memory debugging, talloc contains routines to inspect the currently allocated memory hierarchy.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga6d768b15869983da2040e3665fef9fdf"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga6d768b15869983da2040e3665fef9fdf"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TALLOC_MAX_DEPTH</b>&#160;&#160;&#160;10000</td></tr>
<tr class="separator:ga6d768b15869983da2040e3665fef9fdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga10ceb5acd36e5b97e623907af140d954"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__talloc__debug.html#ga10ceb5acd36e5b97e623907af140d954">talloc_report_depth_cb</a> (const void *ptr, int depth, int max_depth, void(*callback)(const void *ptr,           int depth, int max_depth,           int is_ref,           void *private_data), void *private_data)</td></tr>
<tr class="memdesc:ga10ceb5acd36e5b97e623907af140d954"><td class="mdescLeft">&#160;</td><td class="mdescRight">Walk a complete talloc hierarchy.  <a href="#ga10ceb5acd36e5b97e623907af140d954">More...</a><br /></td></tr>
<tr class="separator:ga10ceb5acd36e5b97e623907af140d954"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga13062669ca8e4b787911c206e339f61c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__talloc__debug.html#ga13062669ca8e4b787911c206e339f61c">talloc_report_depth_file</a> (const void *ptr, int depth, int max_depth, FILE *f)</td></tr>
<tr class="memdesc:ga13062669ca8e4b787911c206e339f61c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a talloc hierarchy.  <a href="#ga13062669ca8e4b787911c206e339f61c">More...</a><br /></td></tr>
<tr class="separator:ga13062669ca8e4b787911c206e339f61c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga66136eb6105416bfcbd390ce6a4fc89c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__talloc__debug.html#ga66136eb6105416bfcbd390ce6a4fc89c">talloc_report_full</a> (const void *ptr, FILE *f)</td></tr>
<tr class="memdesc:ga66136eb6105416bfcbd390ce6a4fc89c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a summary report of all memory used by ptr.  <a href="#ga66136eb6105416bfcbd390ce6a4fc89c">More...</a><br /></td></tr>
<tr class="separator:ga66136eb6105416bfcbd390ce6a4fc89c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4f4ff95ce5a95f61cc453fc943e3de65"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__talloc__debug.html#ga4f4ff95ce5a95f61cc453fc943e3de65">talloc_report</a> (const void *ptr, FILE *f)</td></tr>
<tr class="memdesc:ga4f4ff95ce5a95f61cc453fc943e3de65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a summary report of all memory used by ptr.  <a href="#ga4f4ff95ce5a95f61cc453fc943e3de65">More...</a><br /></td></tr>
<tr class="separator:ga4f4ff95ce5a95f61cc453fc943e3de65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad50534c2b22274a94c722f0790ae102f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__talloc__debug.html#gad50534c2b22274a94c722f0790ae102f">talloc_enable_null_tracking</a> (void)</td></tr>
<tr class="memdesc:gad50534c2b22274a94c722f0790ae102f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable tracking the use of NULL memory contexts.  <a href="#gad50534c2b22274a94c722f0790ae102f">More...</a><br /></td></tr>
<tr class="separator:gad50534c2b22274a94c722f0790ae102f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabd90af3895fee1960e90590fabe92a99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__talloc__debug.html#gabd90af3895fee1960e90590fabe92a99">talloc_enable_null_tracking_no_autofree</a> (void)</td></tr>
<tr class="memdesc:gabd90af3895fee1960e90590fabe92a99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable tracking the use of NULL memory contexts.  <a href="#gabd90af3895fee1960e90590fabe92a99">More...</a><br /></td></tr>
<tr class="separator:gabd90af3895fee1960e90590fabe92a99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2d7d9d0b7c8ca726c537080f20de97e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__talloc__debug.html#ga2d7d9d0b7c8ca726c537080f20de97e1">talloc_disable_null_tracking</a> (void)</td></tr>
<tr class="memdesc:ga2d7d9d0b7c8ca726c537080f20de97e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable tracking of the NULL memory context.  <a href="#ga2d7d9d0b7c8ca726c537080f20de97e1">More...</a><br /></td></tr>
<tr class="separator:ga2d7d9d0b7c8ca726c537080f20de97e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac6f0c065b4ed391acb5c74240a8647bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__talloc__debug.html#gac6f0c065b4ed391acb5c74240a8647bc">talloc_enable_leak_report</a> (void)</td></tr>
<tr class="memdesc:gac6f0c065b4ed391acb5c74240a8647bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable leak report when a program exits.  <a href="#gac6f0c065b4ed391acb5c74240a8647bc">More...</a><br /></td></tr>
<tr class="separator:gac6f0c065b4ed391acb5c74240a8647bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab01ab00014902d25e9eaba9fd172821c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__talloc__debug.html#gab01ab00014902d25e9eaba9fd172821c">talloc_enable_leak_report_full</a> (void)</td></tr>
<tr class="memdesc:gab01ab00014902d25e9eaba9fd172821c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable full leak report when a program exits.  <a href="#gab01ab00014902d25e9eaba9fd172821c">More...</a><br /></td></tr>
<tr class="separator:gab01ab00014902d25e9eaba9fd172821c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga37273c95255f727c2e50be93ffe8d90d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__talloc__debug.html#ga37273c95255f727c2e50be93ffe8d90d">talloc_set_abort_fn</a> (void(*abort_fn)(const char *reason))</td></tr>
<tr class="memdesc:ga37273c95255f727c2e50be93ffe8d90d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a custom "abort" function that is called on serious error.  <a href="#ga37273c95255f727c2e50be93ffe8d90d">More...</a><br /></td></tr>
<tr class="separator:ga37273c95255f727c2e50be93ffe8d90d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5694661cc56931d6edfd926043e43cce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__talloc__debug.html#ga5694661cc56931d6edfd926043e43cce">talloc_set_log_fn</a> (void(*log_fn)(const char *message))</td></tr>
<tr class="memdesc:ga5694661cc56931d6edfd926043e43cce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a logging function.  <a href="#ga5694661cc56931d6edfd926043e43cce">More...</a><br /></td></tr>
<tr class="separator:ga5694661cc56931d6edfd926043e43cce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga28b5f73a0dc144abc1c4a231d2d2842f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__talloc__debug.html#ga28b5f73a0dc144abc1c4a231d2d2842f">talloc_set_log_stderr</a> (void)</td></tr>
<tr class="memdesc:ga28b5f73a0dc144abc1c4a231d2d2842f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set stderr as the output for logs.  <a href="#ga28b5f73a0dc144abc1c4a231d2d2842f">More...</a><br /></td></tr>
<tr class="separator:ga28b5f73a0dc144abc1c4a231d2d2842f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga28e83930f76844782e500a6041a2d452"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__talloc__debug.html#ga28e83930f76844782e500a6041a2d452">talloc_set_memlimit</a> (const void *ctx, size_t max_size)</td></tr>
<tr class="memdesc:ga28e83930f76844782e500a6041a2d452"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a max memory limit for the current context hierarchy This affects all children of this context and constrain any allocation in the hierarchy to never exceed the limit set.  <a href="#ga28e83930f76844782e500a6041a2d452">More...</a><br /></td></tr>
<tr class="separator:ga28e83930f76844782e500a6041a2d452"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>To aid memory debugging, talloc contains routines to inspect the currently allocated memory hierarchy. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga2d7d9d0b7c8ca726c537080f20de97e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void talloc_disable_null_tracking </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disable tracking of the NULL memory context. </p>
<p>This disables tracking of the NULL memory context. </p>

</div>
</div>
<a class="anchor" id="gac6f0c065b4ed391acb5c74240a8647bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void talloc_enable_leak_report </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable leak report when a program exits. </p>
<p>This enables calling of talloc_report(NULL, stderr) when the program exits. In Samba4 this is enabled by using the &ndash;leak-report command line option.</p>
<p>For it to be useful, this function must be called before any other talloc function as it establishes a "null context" that acts as the top of the tree. If you don't call this function first then passing NULL to <a class="el" href="group__talloc__debug.html#ga4f4ff95ce5a95f61cc453fc943e3de65" title="Print a summary report of all memory used by ptr. ">talloc_report()</a> or <a class="el" href="group__talloc__debug.html#ga66136eb6105416bfcbd390ce6a4fc89c" title="Print a summary report of all memory used by ptr. ">talloc_report_full()</a> won't give you the full tree printout.</p>
<p>Here is a typical talloc report:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;talloc report on &#39;null_context&#39; (total 267 bytes in 15 blocks)</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;     libcli/auth/spnego_parse.c:55  contains     31 bytes in   2 blocks</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;     libcli/auth/spnego_parse.c:55  contains     31 bytes in   2 blocks</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;     iconv(UTF8,CP850)              contains     42 bytes in   2 blocks</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;     libcli/auth/spnego_parse.c:55  contains     31 bytes in   2 blocks</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;     iconv(CP850,UTF8)              contains     42 bytes in   2 blocks</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;     iconv(UTF8,UTF-16LE)           contains     45 bytes in   2 blocks</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;     iconv(UTF-16LE,UTF8)           contains     45 bytes in   2 blocks</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gab01ab00014902d25e9eaba9fd172821c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void talloc_enable_leak_report_full </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable full leak report when a program exits. </p>
<p>This enables calling of talloc_report_full(NULL, stderr) when the program exits. In Samba4 this is enabled by using the &ndash;leak-report-full command line option.</p>
<p>For it to be useful, this function must be called before any other talloc function as it establishes a "null context" that acts as the top of the tree. If you don't call this function first then passing NULL to <a class="el" href="group__talloc__debug.html#ga4f4ff95ce5a95f61cc453fc943e3de65" title="Print a summary report of all memory used by ptr. ">talloc_report()</a> or <a class="el" href="group__talloc__debug.html#ga66136eb6105416bfcbd390ce6a4fc89c" title="Print a summary report of all memory used by ptr. ">talloc_report_full()</a> won't give you the full tree printout.</p>
<p>Here is a typical full report:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;full talloc report on &#39;root&#39; (total 18 bytes in 8 blocks)</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;     p1                             contains     18 bytes in   7 blocks (ref 0)</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;     r1                             contains     13 bytes in   2 blocks (ref 0)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;     reference to: p2</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;     p2                             contains      1 bytes in   1 blocks (ref 1)</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;     x3                             contains      1 bytes in   1 blocks (ref 0)</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;     x2                             contains      1 bytes in   1 blocks (ref 0)</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;     x1                             contains      1 bytes in   1 blocks (ref 0)</div>
</div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="gad50534c2b22274a94c722f0790ae102f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void talloc_enable_null_tracking </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable tracking the use of NULL memory contexts. </p>
<p>This enables tracking of the NULL memory context without enabling leak reporting on exit. Useful for when you want to do your own leak reporting call via talloc_report_null_full(); </p>

</div>
</div>
<a class="anchor" id="gabd90af3895fee1960e90590fabe92a99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void talloc_enable_null_tracking_no_autofree </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable tracking the use of NULL memory contexts. </p>
<p>This enables tracking of the NULL memory context without enabling leak reporting on exit. Useful for when you want to do your own leak reporting call via talloc_report_null_full(); </p>

</div>
</div>
<a class="anchor" id="ga4f4ff95ce5a95f61cc453fc943e3de65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void talloc_report </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print a summary report of all memory used by ptr. </p>
<p>This function prints a summary report of all memory used by ptr. One line of report is printed for each immediate child of ptr, showing the total memory and number of blocks used by that child.</p>
<p>You can pass NULL for the pointer, in which case a report is printed for the top level memory context, but only if <a class="el" href="group__talloc__debug.html#gac6f0c065b4ed391acb5c74240a8647bc" title="Enable leak report when a program exits. ">talloc_enable_leak_report()</a> or <a class="el" href="group__talloc__debug.html#gab01ab00014902d25e9eaba9fd172821c" title="Enable full leak report when a program exits. ">talloc_enable_leak_report_full()</a> has been called.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ptr</td><td>The talloc chunk.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>The file handle to print to.</td></tr>
  </table>
  </dd>
</dl>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;unsigned int *a, *b;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;a = talloc(NULL, unsigned int);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;b = talloc(a, unsigned int);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;fprintf(stderr, &quot;Summary of memory tree for a:\n&quot;);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;talloc_report(a, stderr);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__talloc__debug.html#ga66136eb6105416bfcbd390ce6a4fc89c" title="Print a summary report of all memory used by ptr. ">talloc_report_full()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga10ceb5acd36e5b97e623907af140d954"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void talloc_report_depth_cb </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(const void *ptr,                                   int depth, int max_depth,                                   int is_ref,                                   void *private_data)&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>private_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Walk a complete talloc hierarchy. </p>
<p>This provides a more flexible reports than <a class="el" href="group__talloc__debug.html#ga4f4ff95ce5a95f61cc453fc943e3de65" title="Print a summary report of all memory used by ptr. ">talloc_report()</a>. It will recursively call the callback for the entire tree of memory referenced by the pointer. References in the tree are passed with is_ref = 1 and the pointer that is referenced.</p>
<p>You can pass NULL for the pointer, in which case a report is printed for the top level memory context, but only if <a class="el" href="group__talloc__debug.html#gac6f0c065b4ed391acb5c74240a8647bc" title="Enable leak report when a program exits. ">talloc_enable_leak_report()</a> or <a class="el" href="group__talloc__debug.html#gab01ab00014902d25e9eaba9fd172821c" title="Enable full leak report when a program exits. ">talloc_enable_leak_report_full()</a> has been called.</p>
<p>The recursion is stopped when depth &gt;= max_depth. max_depth = -1 means only stop at leaf nodes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ptr</td><td>The talloc chunk.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>Internal parameter to control recursion. Call with 0.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_depth</td><td>Maximum recursion level.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">callback</td><td>Function to be called on every chunk.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">private_data</td><td>Private pointer passed to callback. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga13062669ca8e4b787911c206e339f61c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void talloc_report_depth_file </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print a talloc hierarchy. </p>
<p>This provides a more flexible reports than <a class="el" href="group__talloc__debug.html#ga4f4ff95ce5a95f61cc453fc943e3de65" title="Print a summary report of all memory used by ptr. ">talloc_report()</a>. It will let you specify the depth and max_depth.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ptr</td><td>The talloc chunk.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>Internal parameter to control recursion. Call with 0.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_depth</td><td>Maximum recursion level.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>The file handle to print to. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga66136eb6105416bfcbd390ce6a4fc89c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void talloc_report_full </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print a summary report of all memory used by ptr. </p>
<p>This provides a more detailed report than <a class="el" href="group__talloc__debug.html#ga4f4ff95ce5a95f61cc453fc943e3de65" title="Print a summary report of all memory used by ptr. ">talloc_report()</a>. It will recursively print the entire tree of memory referenced by the pointer. References in the tree are shown by giving the name of the pointer that is referenced.</p>
<p>You can pass NULL for the pointer, in which case a report is printed for the top level memory context, but only if <a class="el" href="group__talloc__debug.html#gac6f0c065b4ed391acb5c74240a8647bc" title="Enable leak report when a program exits. ">talloc_enable_leak_report()</a> or <a class="el" href="group__talloc__debug.html#gab01ab00014902d25e9eaba9fd172821c" title="Enable full leak report when a program exits. ">talloc_enable_leak_report_full()</a> has been called.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ptr</td><td>The talloc chunk.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>The file handle to print to.</td></tr>
  </table>
  </dd>
</dl>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;unsigned int *a, *b;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;a = talloc(NULL, unsigned int);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;b = talloc(a, unsigned int);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;fprintf(stderr, &quot;Dumping memory tree for a:\n&quot;);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;talloc_report_full(a, stderr);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__talloc__debug.html#ga4f4ff95ce5a95f61cc453fc943e3de65" title="Print a summary report of all memory used by ptr. ">talloc_report()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga37273c95255f727c2e50be93ffe8d90d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void talloc_set_abort_fn </td>
          <td>(</td>
          <td class="paramtype">void(*)(const char *reason)&#160;</td>
          <td class="paramname"><em>abort_fn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a custom "abort" function that is called on serious error. </p>
<p>The default "abort" function is <code>abort()</code>.</p>
<p>The "abort" function is called when:</p>
<ul>
<li>
talloc_get_type_abort() fails </li>
<li>
the provided pointer is not a valid talloc context </li>
<li>
when the context meta data are invalid </li>
<li>
when access after free is detected </li>
</ul>
<p>Example:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void my_abort(const char *reason)</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;{</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;     fprintf(stderr, &quot;talloc abort: %s\n&quot;, reason);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;     abort();</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;}</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;     talloc_set_abort_fn(my_abort);</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">abort_fn</td><td>The new "abort" function.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__talloc__debug.html#ga5694661cc56931d6edfd926043e43cce" title="Set a logging function. ">talloc_set_log_fn()</a> </dd>
<dd>
talloc_get_type() </dd></dl>

</div>
</div>
<a class="anchor" id="ga5694661cc56931d6edfd926043e43cce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void talloc_set_log_fn </td>
          <td>(</td>
          <td class="paramtype">void(*)(const char *message)&#160;</td>
          <td class="paramname"><em>log_fn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a logging function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">log_fn</td><td>The logging function.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__talloc__debug.html#ga28b5f73a0dc144abc1c4a231d2d2842f" title="Set stderr as the output for logs. ">talloc_set_log_stderr()</a> </dd>
<dd>
<a class="el" href="group__talloc__debug.html#ga37273c95255f727c2e50be93ffe8d90d" title="Set a custom &quot;abort&quot; function that is called on serious error. ">talloc_set_abort_fn()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga28b5f73a0dc144abc1c4a231d2d2842f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void talloc_set_log_stderr </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set stderr as the output for logs. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__talloc__debug.html#ga5694661cc56931d6edfd926043e43cce" title="Set a logging function. ">talloc_set_log_fn()</a> </dd>
<dd>
<a class="el" href="group__talloc__debug.html#ga37273c95255f727c2e50be93ffe8d90d" title="Set a custom &quot;abort&quot; function that is called on serious error. ">talloc_set_abort_fn()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga28e83930f76844782e500a6041a2d452"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int talloc_set_memlimit </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a max memory limit for the current context hierarchy This affects all children of this context and constrain any allocation in the hierarchy to never exceed the limit set. </p>
<p>The limit can be removed by setting 0 (unlimited) as the max_size by calling the funciton again on the sam context. Memory limits can also be nested, meaning a hild can have a stricter memory limit than a parent. Memory limits are enforced only at memory allocation time. Stealing a context into a 'limited' hierarchy properly updates memory usage but does <em>not</em> cause failure if the move causes the new parent to exceed its limits. However any further allocation on that hierarchy will then fail.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The talloc context to set the limit on </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_size</td><td>The (new) max_size </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
